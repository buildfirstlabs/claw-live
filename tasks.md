# Loop Tasks — Claw Live Roadmap Execution

Status legend: `todo` | `in_progress` | `done` | `blocked`
Rule: one cycle = one atomic step + proof.

## Phase 0.5 — Reliability Foundations (current)
1. [done] Heartbeat runtime + liveness scheduler (`live/stale/offline`).
2. [done] Endpoint statut registry (`/api/v2/registry/status`).
3. [done] Persistance registry disque + TTL cleanup offline.
4. [done] Affichage liveness sur page live.
5. [done] UX statut clarifiée: `STREAM` vs `AGENT`.
6. [done] Replay append-only persistant (`stream_events.jsonl`).
7. [done] Export replay endpoint (`GET /api/stream/replay`).
8. [done] Redaction minimale des secrets à l’ingestion.
9. [done] Docs sync réel (README / VISION / UPDATES).
10. [done] Home: statut agent visible sur cards + badge verified cohérent.
11. [done] Profile: layout final propre + entry point replay/live history.
12. [blocked] QA mobile complète (iPhone/Safari + Android/Chrome) sur la version live actuelle. (2026-02-23 05:46Z: tentative d’exécution via browser tool impossible — service browser OpenClaw indisponible sur cet hôte, erreur: "No supported browser found". En attente d’un runtime avec Chrome/Chromium pour continuer.)
13. [done] Playbook incident court (stream ON mais 0 events, registry vide, etc.).

### DoD 0.5 closing tasks
14. [done] Patch redaction stricte replay/raw pour couvrir `authorization=Bearer ...`, `ghp_...`, et patterns token équivalents.
15. [blocked] Ajouter/valider tests de régression redaction (fixtures malicieuses) + preuve PASS. (2026-02-23: test script ajouté, échec sur fuite `gho_...` dans replay raw; cycle suivant: tentative de restart `claw-live.service` bloquée par droits systemd (`Interactive authentication required`), impossible de recharger le patch pour valider PASS. 2026-02-23 05:30Z: 3e cycle bloqué confirmé via `node scripts/test-redaction-regression.js` (fuite `gho_...`) → escaladé, on passe au prochain task prêt.)
16. [blocked] Re-run cold-start QA (nouvelle session navigateur + mobile) et documenter PASS. (2026-02-23 06:00Z: tentative de lancement browser automation impossible — OpenClaw browser control indisponible + aucun navigateur supporté détecté sur cet hôte; blocage infra, QA non exécutable. 2026-02-23 06:45Z: recheck effectué via browser status (`running=false`, `detectedBrowser=null`) → blocage infra confirmé, QA toujours non exécutable sur cet hôte. 2026-02-23 07:00Z: 3e cycle bloqué confirmé (`running=false`, `detectedBrowser=null`) → ESCALADE: dépendance runtime navigateur absente sur l’hôte; on bascule sur le prochain task prêt #18 en attendant déblocage infra.)
17. [blocked] Mettre à jour doc de clôture 0.5 avec preuves finales et passer statut à `done` si zero leak confirmé. (2026-02-23 06:15Z: doc UPDATES enrichie avec état de clôture 0.5 + preuves disponibles; reste `todo` tant que les tests de régression redaction #15 ne sont pas PASS et QA cold-start #16 non validée. 2026-02-23 06:30Z: task passé `blocked` car dépendances de clôture non satisfaites (#15 redaction regression PASS manquant, #16 cold-start QA non exécutable en l’état infra).)

## Phase 1 — Social Layer
18. [done] Directory agents clean (tri + état live). (2026-02-23 07:16Z: directory `/agents` now merges registry runtime status (`live/stale/offline`), sorts cards by status priority then name, and shows accurate status chip; proof commit `1fab4a9`.)
19. [blocked] Pages profile/projets production-ready. (2026-02-23 07:30Z: étape atomique livrée — ajout route page projet dédiée `/agents/:agentName/projects/:projectId` + liens projets du profil redirigés vers cette page; reste du hardening/UI final à terminer dans prochains cycles.) (2026-02-23 07:33Z: step atomique livré — cards projets du profile pointent vers `/agents/:agent/projects/:projectId` + nouvelle page projet serveur (hero + description + repo + CTA live/replay). Reste à finaliser critères “production-ready” complets avant passage `done`.) (2026-02-23 07:45Z: étape atomique livrée — hardening sécurité de la page projet: échappement HTML des champs dynamiques (nom/status/description/github/id) + URLs encodées pour éviter injection/XSS; preuve commit `16a30f3` + `node --check server.js` PASS.) (2026-02-23 08:00Z: étape atomique livrée — normalisation robuste du badge statut projet (`LIVE` insensible à la casse) + lien profil encodé/réutilisé (`profileHref`) pour éviter incohérences d’URL sur identifiants spéciaux; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 08:00Z: étape atomique livrée — robustesse status/profile links sur page projet: détection `LIVE` rendue case-insensitive (`projectIsLive`) + `profileHref` encodé/réutilisé pour tous les liens retour profil; preuve `node --check server.js` PASS.) (2026-02-23 08:15Z: étape atomique livrée — encodage systématique des segments URL dynamiques sur page profile (`agentName`, `project.id`) pour liens projets + CTA live/history, afin d’éviter liens cassés sur identifiants spéciaux; preuve commit `a0b78bb` + `node --check server.js` PASS.) (2026-02-23 08:30Z: étape atomique livrée — échappement HTML des champs dynamiques sur les cards projets de la page profile (`name/github/status/description`) + badge LIVE case-insensitive, pour éviter injection XSS côté profile; preuve commit `9ffa797` + `node --check server.js` PASS.) (2026-02-23 08:46Z: étape atomique livrée — carte Repository de la page projet durcie/production-ready: lien externe cliquable seulement si URL `http/https` valide (`toSafeExternalHref`), sinon fallback texte neutre; ajout `target=_blank` + `rel="noopener noreferrer"` pour sécurité. preuve commit `181bf45` + `node --check server.js` PASS.) (2026-02-23 09:00Z: étape atomique livrée — hardening page history: handle agent échappé dans title/H1 (`safeAgentName`) + liens `Watch Live`/`Back to Profile` encodés (`encodeURIComponent`) pour éviter injection/URL cassées via identifiants spéciaux; preuve commit `a15a364` + `node --check server.js` PASS.) (2026-02-23 09:15Z: étape atomique livrée — hardening profile page: échappement des champs dynamiques `agentName` (incluant 404/title/UI), `bio`, `owner_email`, `createdDate`, et construction sûre du lien Twitter via handle normalisé+encodé pour réduire risques XSS/injection attributaire; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 09:15Z: étape atomique livrée — page 404 profile durcie: handle agent non-claimé échappé via `safeAgentParam` pour éviter injection HTML dans message `Agent Not Found`; preuve commit `5449ce5` + `node --check server.js` PASS.) (2026-02-23 09:15Z: étape atomique livrée — CTA Follow de la page profile durcie: `twitterHref` validé via `toSafeExternalHref` + ajout `rel="noopener noreferrer"` sur lien externe `target=_blank` pour réduire risques d’URL unsafe/tabnabbing; preuve commit enregistré + `node --check server.js` PASS.) (2026-02-23 09:30Z: étape atomique livrée — réponse API claim flow durcie: `profileUrl` renvoyée par `/api/agents/verify-tweet` encode désormais `agentName` via `encodeURIComponent` pour éviter URL cassées/injection de chemin; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 09:46Z: étape atomique livrée — normalisation robuste du compteur followers sur page profile: conversion numérique stricte de `agent.followers`, fallback sécurisé si valeur invalide, et rendu via `followerCountK` pré-calculé pour éviter affichage `NaN`/valeurs non fiables; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 09:45Z: étape atomique livrée — hardening robustesse cards projets profile: lien projet construit via `projectIdRaw` (trim) et fallback `#` si id absent pour éviter URLs `/projects/undefined` en production; preuve commit enregistré + `node --check server.js` PASS.) (2026-02-23 10:00Z: étape atomique livrée — hardening CTA live de la page projet: `liveHref` construit depuis `projectIdRaw` (trim) avec fallback `#` si id manquant pour éviter route `/live/.../undefined`; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 10:00Z: étape atomique livrée — hardening robustesse page projet: lien CTA `Watch Live` sécurisé avec `projectIdRaw` (trim) et fallback `#` si `project.id` absent pour éviter URLs live cassées sur données incomplètes; preuve commit `pending` + `node --check server.js` PASS.) (2026-02-23 10:00Z: no-op contrôlé — tentative de nouveau hardening CTA live abandonnée car protection `projectIdRaw` + fallback `#` déjà présente dans `server.js`; validation exécutée via `grep projectIdRaw` + `node --check server.js` PASS. Task #19 reste `todo`.) (2026-02-23 10:15Z: étape atomique livrée — hardening robustesse page history: normalisation `primaryProjectIdRaw` (trim string) + fallback explicite `claw-live` avant construction de `liveHref`, pour éviter route `/live/.../undefined` si `projects[0].id` est vide/null; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 10:30Z: étape atomique livrée — hardening CTA principal de la page profile: normalisation `primaryProjectIdRaw` (trim) + fallback `claw-live` avant encodage, pour éviter lien `Go Live Feed` cassé quand `projects[0].id` est vide/null; preuve commit `ffa795d` + `node --check server.js` PASS.) (2026-02-23 10:45Z: étape atomique livrée — robustesse lookup projet sur route `/agents/:agentName/projects/:projectId`: normalisation `requestedProjectId` (trim + lowercase) et comparaison contre `p.id` normalisé (`String(p.id || '').trim().toLowerCase()`), pour éviter faux 404 sur IDs avec espaces/casse variable; preuve commit `474632a` + `node --check server.js` PASS.) (2026-02-23 11:00Z: étape atomique livrée — robustesse profile page: fallback `createdDateStr='Unknown'` si `agent.created_at` est invalide (`Invalid Date`) pour éviter rendu date cassé en production; preuve commit `5d14a67` + `node --check server.js` PASS.) (2026-02-23 11:15Z: étape atomique livrée — hardening profile page: compteur `Total Commits` désormais normalisé côté serveur (`Number(agent.commits)` + garde `>=0` + `Math.floor`), pour éviter affichage non fiable/injection si la donnée est corrompue/non numérique; preuve commit `0b7e9e3` + `node --check server.js` PASS.) (2026-02-23 11:30Z: étape atomique livrée — hardening sécurité liens externes de l’en-tête profile: ajout `rel="noopener noreferrer"` sur liens `x.com/claw_live` et GitHub ouverts en `target="_blank"` pour réduire risque tabnabbing; preuve commit `8b7db25` + `node --check server.js` PASS.) (2026-02-23 11:45Z: étape atomique livrée — hardening sécurité footer profile: ajout `rel="noopener noreferrer"` sur liens externes `Source Code` et `Twitter` ouverts en `target="_blank"` pour réduire risque tabnabbing; preuve commit enregistrée (voir git log) + `node --check server.js` PASS.) (2026-02-23 12:00Z: étape atomique livrée — normalisation robuste du statut projet sur page projet: `project.status` est désormais `trim().toUpperCase()` avant rendu badge et détection LIVE (`normalizedProjectStatus`), évitant incohérences de casse/espaces en prod; preuve commit `e57b7da` + `node --check server.js` PASS.) (2026-02-23 12:15Z: étape atomique livrée — normalisation robuste du statut sur les cards projets de la page profile: `proj.status` est désormais `trim().toUpperCase()` avant rendu badge et détection LIVE (`normalizedProjectStatus`), évitant incohérences UI (espaces/casse) entre profile et page projet; preuve commit `8e7556e` + `node --check server.js` PASS.) (2026-02-23 12:30Z: étape atomique livrée — hardening sécurité sur route live projet: paramètres URL `agentName`/`projectId` désormais échappés dans les templates 404 (`safeAgentName`, `safeProjectId`) + lien profil construit via `encodeURIComponent` (`agentProfileHref`) pour éviter injection HTML/URL cassée sur entrée hostile; preuve commit `db92589` + `node --check server.js` PASS.) (2026-02-23 12:45Z: étape atomique livrée — robustesse claim flow: `twitterHandle` normalisé côté API (`trim`, retrait de `@`, lower-case) avec validation stricte `^[a-z0-9_]{1,15}# Loop Tasks — Claw Live Roadmap Execution (2026-02-27 07:15Z: ESCALADE — 3 cycles consécutifs sans delta atomique sûr (06:30Z no-op, 07:00Z no-op, 07:15Z no-op). Task #19 est bloquée par absence de sous-tâche atomique restante sans élargir le scope. Bascule vers task #20 (Follow graph minimal) au prochain cycle.)

Status legend: `todo` | `in_progress` | `done` | `blocked`
Rule: one cycle = one atomic step + proof.

## Phase 0.5 — Reliability Foundations (current)
1. [done] Heartbeat runtime + liveness scheduler (`live/stale/offline`).
2. [done] Endpoint statut registry (`/api/v2/registry/status`).
3. [done] Persistance registry disque + TTL cleanup offline.
4. [done] Affichage liveness sur page live.
5. [done] UX statut clarifiée: `STREAM` vs `AGENT`.
6. [done] Replay append-only persistant (`stream_events.jsonl`).
7. [done] Export replay endpoint (`GET /api/stream/replay`).
8. [done] Redaction minimale des secrets à l’ingestion.
9. [done] Docs sync réel (README / VISION / UPDATES).
10. [done] Home: statut agent visible sur cards + badge verified cohérent.
11. [done] Profile: layout final propre + entry point replay/live history.
12. [blocked] QA mobile complète (iPhone/Safari + Android/Chrome) sur la version live actuelle. (2026-02-23 05:46Z: tentative d’exécution via browser tool impossible — service browser OpenClaw indisponible sur cet hôte, erreur: "No supported browser found". En attente d’un runtime avec Chrome/Chromium pour continuer.)
13. [done] Playbook incident court (stream ON mais 0 events, registry vide, etc.).

### DoD 0.5 closing tasks
14. [done] Patch redaction stricte replay/raw pour couvrir `authorization=Bearer ...`, `ghp_...`, et patterns token équivalents.
15. [blocked] Ajouter/valider tests de régression redaction (fixtures malicieuses) + preuve PASS. (2026-02-23: test script ajouté, échec sur fuite `gho_...` dans replay raw; cycle suivant: tentative de restart `claw-live.service` bloquée par droits systemd (`Interactive authentication required`), impossible de recharger le patch pour valider PASS. 2026-02-23 05:30Z: 3e cycle bloqué confirmé via `node scripts/test-redaction-regression.js` (fuite `gho_...`) → escaladé, on passe au prochain task prêt.)
16. [blocked] Re-run cold-start QA (nouvelle session navigateur + mobile) et documenter PASS. (2026-02-23 06:00Z: tentative de lancement browser automation impossible — OpenClaw browser control indisponible + aucun navigateur supporté détecté sur cet hôte; blocage infra, QA non exécutable. 2026-02-23 06:45Z: recheck effectué via browser status (`running=false`, `detectedBrowser=null`) → blocage infra confirmé, QA toujours non exécutable sur cet hôte. 2026-02-23 07:00Z: 3e cycle bloqué confirmé (`running=false`, `detectedBrowser=null`) → ESCALADE: dépendance runtime navigateur absente sur l’hôte; on bascule sur le prochain task prêt #18 en attendant déblocage infra.)
17. [blocked] Mettre à jour doc de clôture 0.5 avec preuves finales et passer statut à `done` si zero leak confirmé. (2026-02-23 06:15Z: doc UPDATES enrichie avec état de clôture 0.5 + preuves disponibles; reste `todo` tant que les tests de régression redaction #15 ne sont pas PASS et QA cold-start #16 non validée. 2026-02-23 06:30Z: task passé `blocked` car dépendances de clôture non satisfaites (#15 redaction regression PASS manquant, #16 cold-start QA non exécutable en l’état infra).)

## Phase 1 — Social Layer
18. [done] Directory agents clean (tri + état live). (2026-02-23 07:16Z: directory `/agents` now merges registry runtime status (`live/stale/offline`), sorts cards by status priority then name, and shows accurate status chip; proof commit `1fab4a9`.)
19. [todo] Pages profile/projets production-ready. (2026-02-23 07:30Z: étape atomique livrée — ajout route page projet dédiée `/agents/:agentName/projects/:projectId` + liens projets du profil redirigés vers cette page; reste du hardening/UI final à terminer dans prochains cycles.) (2026-02-23 07:33Z: step atomique livré — cards projets du profile pointent vers `/agents/:agent/projects/:projectId` + nouvelle page projet serveur (hero + description + repo + CTA live/replay). Reste à finaliser critères “production-ready” complets avant passage `done`.) (2026-02-23 07:45Z: étape atomique livrée — hardening sécurité de la page projet: échappement HTML des champs dynamiques (nom/status/description/github/id) + URLs encodées pour éviter injection/XSS; preuve commit `16a30f3` + `node --check server.js` PASS.) (2026-02-23 08:00Z: étape atomique livrée — normalisation robuste du badge statut projet (`LIVE` insensible à la casse) + lien profil encodé/réutilisé (`profileHref`) pour éviter incohérences d’URL sur identifiants spéciaux; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 08:00Z: étape atomique livrée — robustesse status/profile links sur page projet: détection `LIVE` rendue case-insensitive (`projectIsLive`) + `profileHref` encodé/réutilisé pour tous les liens retour profil; preuve `node --check server.js` PASS.) (2026-02-23 08:15Z: étape atomique livrée — encodage systématique des segments URL dynamiques sur page profile (`agentName`, `project.id`) pour liens projets + CTA live/history, afin d’éviter liens cassés sur identifiants spéciaux; preuve commit `a0b78bb` + `node --check server.js` PASS.) (2026-02-23 08:30Z: étape atomique livrée — échappement HTML des champs dynamiques sur les cards projets de la page profile (`name/github/status/description`) + badge LIVE case-insensitive, pour éviter injection XSS côté profile; preuve commit `9ffa797` + `node --check server.js` PASS.) (2026-02-23 08:46Z: étape atomique livrée — carte Repository de la page projet durcie/production-ready: lien externe cliquable seulement si URL `http/https` valide (`toSafeExternalHref`), sinon fallback texte neutre; ajout `target=_blank` + `rel="noopener noreferrer"` pour sécurité. preuve commit `181bf45` + `node --check server.js` PASS.) (2026-02-23 09:00Z: étape atomique livrée — hardening page history: handle agent échappé dans title/H1 (`safeAgentName`) + liens `Watch Live`/`Back to Profile` encodés (`encodeURIComponent`) pour éviter injection/URL cassées via identifiants spéciaux; preuve commit `a15a364` + `node --check server.js` PASS.) (2026-02-23 09:15Z: étape atomique livrée — hardening profile page: échappement des champs dynamiques `agentName` (incluant 404/title/UI), `bio`, `owner_email`, `createdDate`, et construction sûre du lien Twitter via handle normalisé+encodé pour réduire risques XSS/injection attributaire; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 09:15Z: étape atomique livrée — page 404 profile durcie: handle agent non-claimé échappé via `safeAgentParam` pour éviter injection HTML dans message `Agent Not Found`; preuve commit `5449ce5` + `node --check server.js` PASS.) (2026-02-23 09:15Z: étape atomique livrée — CTA Follow de la page profile durcie: `twitterHref` validé via `toSafeExternalHref` + ajout `rel="noopener noreferrer"` sur lien externe `target=_blank` pour réduire risques d’URL unsafe/tabnabbing; preuve commit enregistré + `node --check server.js` PASS.) (2026-02-23 09:30Z: étape atomique livrée — réponse API claim flow durcie: `profileUrl` renvoyée par `/api/agents/verify-tweet` encode désormais `agentName` via `encodeURIComponent` pour éviter URL cassées/injection de chemin; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 09:46Z: étape atomique livrée — normalisation robuste du compteur followers sur page profile: conversion numérique stricte de `agent.followers`, fallback sécurisé si valeur invalide, et rendu via `followerCountK` pré-calculé pour éviter affichage `NaN`/valeurs non fiables; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 09:45Z: étape atomique livrée — hardening robustesse cards projets profile: lien projet construit via `projectIdRaw` (trim) et fallback `#` si id absent pour éviter URLs `/projects/undefined` en production; preuve commit enregistré + `node --check server.js` PASS.) (2026-02-23 10:00Z: étape atomique livrée — hardening CTA live de la page projet: `liveHref` construit depuis `projectIdRaw` (trim) avec fallback `#` si id manquant pour éviter route `/live/.../undefined`; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 10:00Z: étape atomique livrée — hardening robustesse page projet: lien CTA `Watch Live` sécurisé avec `projectIdRaw` (trim) et fallback `#` si `project.id` absent pour éviter URLs live cassées sur données incomplètes; preuve commit `pending` + `node --check server.js` PASS.) (2026-02-23 10:00Z: no-op contrôlé — tentative de nouveau hardening CTA live abandonnée car protection `projectIdRaw` + fallback `#` déjà présente dans `server.js`; validation exécutée via `grep projectIdRaw` + `node --check server.js` PASS. Task #19 reste `todo`.) (2026-02-23 10:15Z: étape atomique livrée — hardening robustesse page history: normalisation `primaryProjectIdRaw` (trim string) + fallback explicite `claw-live` avant construction de `liveHref`, pour éviter route `/live/.../undefined` si `projects[0].id` est vide/null; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 10:30Z: étape atomique livrée — hardening CTA principal de la page profile: normalisation `primaryProjectIdRaw` (trim) + fallback `claw-live` avant encodage, pour éviter lien `Go Live Feed` cassé quand `projects[0].id` est vide/null; preuve commit `ffa795d` + `node --check server.js` PASS.) (2026-02-23 10:45Z: étape atomique livrée — robustesse lookup projet sur route `/agents/:agentName/projects/:projectId`: normalisation `requestedProjectId` (trim + lowercase) et comparaison contre `p.id` normalisé (`String(p.id || '').trim().toLowerCase()`), pour éviter faux 404 sur IDs avec espaces/casse variable; preuve commit `474632a` + `node --check server.js` PASS.) (2026-02-23 11:00Z: étape atomique livrée — robustesse profile page: fallback `createdDateStr='Unknown'` si `agent.created_at` est invalide (`Invalid Date`) pour éviter rendu date cassé en production; preuve commit `5d14a67` + `node --check server.js` PASS.) (2026-02-23 11:15Z: étape atomique livrée — hardening profile page: compteur `Total Commits` désormais normalisé côté serveur (`Number(agent.commits)` + garde `>=0` + `Math.floor`), pour éviter affichage non fiable/injection si la donnée est corrompue/non numérique; preuve commit `0b7e9e3` + `node --check server.js` PASS.) (2026-02-23 11:30Z: étape atomique livrée — hardening sécurité liens externes de l’en-tête profile: ajout `rel="noopener noreferrer"` sur liens `x.com/claw_live` et GitHub ouverts en `target="_blank"` pour réduire risque tabnabbing; preuve commit `8b7db25` + `node --check server.js` PASS.) (2026-02-23 11:45Z: étape atomique livrée — hardening sécurité footer profile: ajout `rel="noopener noreferrer"` sur liens externes `Source Code` et `Twitter` ouverts en `target="_blank"` pour réduire risque tabnabbing; preuve commit enregistrée (voir git log) + `node --check server.js` PASS.) (2026-02-23 12:00Z: étape atomique livrée — normalisation robuste du statut projet sur page projet: `project.status` est désormais `trim().toUpperCase()` avant rendu badge et détection LIVE (`normalizedProjectStatus`), évitant incohérences de casse/espaces en prod; preuve commit `e57b7da` + `node --check server.js` PASS.) (2026-02-23 12:15Z: étape atomique livrée — normalisation robuste du statut sur les cards projets de la page profile: `proj.status` est désormais `trim().toUpperCase()` avant rendu badge et détection LIVE (`normalizedProjectStatus`), évitant incohérences UI (espaces/casse) entre profile et page projet; preuve commit `8e7556e` + `node --check server.js` PASS.)  avant persistance/log, pour éviter handles invalides/injectés en production; preuve commit `<pending>` + `node --check server.js` PASS.) (2026-02-23 12:45Z: étape atomique livrée — hardening injection-safe du bootstrap `window.PROJECT_CONTEXT` sur route `/live/:agentName/:projectId`: remplacement de l’interpolation JS directe par sérialisation `JSON.stringify` + neutralisation `<` (`\u003c`) pour réduire le risque d’injection via données projet/agent; preuve commit enregistré (voir git log) + `node --check server.js` PASS.)
(2026-02-23 13:00Z: étape atomique livrée — robustesse claim flow: code de vérification normalisé (`normalizedCode = trim`) et utilisé de bout en bout pour lookup + suppression (`verificationCodes[normalizedCode]`), évitant faux échecs/cleanup raté sur codes avec espaces. preuve commit `5b8a136` + `node --check server.js` PASS.) (2026-02-23 13:00Z: étape atomique livrée — robustesse profile production: fallback `followers` désormais déterministe (`0` au lieu d’une valeur aléatoire) quand donnée invalide/absente, pour éviter jitter UI et métriques trompeuses entre refresh. preuve commit `8b5c312` + `node --check server.js` PASS.) (2026-02-23 13:15Z: étape atomique livrée — robustesse route live projet: lookup `projectId` rendu tolérant casse/espaces (`trim().toLowerCase()`) pour éviter faux 404 quand l’identifiant varie en casing/whitespace entre URL et données projet; preuve commit enregistré (`git log`) + `node --check server.js` PASS.) (2026-02-23 13:15Z: étape atomique livrée — route live durcie côté contexte injecté: `window.PROJECT_CONTEXT` utilise désormais les identifiants canoniques résolus (`agent.name`/`project.id`) avec `trim`, au lieu des paramètres URL bruts, pour éviter incohérences de casse/espaces côté UI/requêtes dérivées; preuve commit enregistré (voir git log) + `node --check server.js` PASS.) (2026-02-27 02:30Z: étape atomique livrée — robustesse route projet: garde explicite `requestedProjectId` non vide sur `/agents/:agentName/projects/:projectId` avant lookup, pour éviter matching ambigu sur identifiants vides/blancs; preuve commit enregistré (voir git log) + `node --check server.js` PASS.) (2026-02-27 02:45Z: étape atomique livrée — robustesse replay history: fallback `Unknown time` si `event.ts` est invalide (au lieu d’afficher `Invalid Date`) via validation `Number.isNaN(tsDate.getTime())`; preuve commit enregistré (voir git log) + `node --check server.js` PASS.) (2026-02-27 03:00Z: no-op contrôlé — audit de robustesse sur Task #19: les routes profile/projet/history appliquent déjà la résolution case-insensitive de `agentName` (grep prouvé aux lignes 811/1174/1269) et `node --check server.js` est PASS; aucun delta sûr/utile additionnel trouvé pour ce cycle atomique, task reste `todo`.) (2026-02-27 03:00Z: étape atomique livrée — robustesse badge statut agent sur page profile: normalisation `registryEntry.status` via `trim().toLowerCase()` avant mapping (`LIVE/STALE/OFFLINE`), évitant faux statut OFFLINE si la registry remonte `LIVE`/` Stale `; preuve commit `2150757` + `node --check server.js` PASS.) (2026-02-27 03:16:02Z: étape atomique livrée — correction robustesse page profile: remplacement de `liveStatus` (variable non définie dans template) par `normalizedLiveStatus` sur les 2 indicateurs visuels de statut afin d’éviter un rendu cassé/ReferenceError dans le template string; preuve commit enregistré (voir `git log`) + `grep -n "normalizedLiveStatus === 'live'" server.js` (lignes 861/862/1037/1139) + `node --check server.js` PASS. Task #19 reste `todo`.) (2026-02-27 03:30Z: no-op contrôlé — aucun nouveau delta sûr identifié pour Task #19 après le fix 03:16Z; vérification exécutée avec `grep -n "liveStatus" server.js` (aucune référence résiduelle à la variable legacy) + `grep -n "normalizedLiveStatus" server.js` (lignes 860/861/862/1037/1139) + `node --check server.js` PASS. Task #19 reste `todo`.) (2026-02-27 03:45Z: no-op contrôlé — audit ciblé relancé sur Task #19; aucun delta atomique sûr supplémentaire trouvé sans élargir le scope Phase 1. Preuve: `grep -n "liveStatus" server.js` => aucune occurrence legacy (exit=1 attendu), `grep -n "normalizedLiveStatus" server.js` => lignes 860/861/862/1037/1139, `node --check server.js` PASS. Task #19 reste `todo`.)
(2026-02-27 06:30Z: étape atomique livrée — Task #19: robustesse followers durcie contre perte de précision IEEE-754 en ajoutant un garde `length > 15` sur la chaîne numérique normalisée; les valeurs trop longues sont clampées directement à `Number.MAX_SAFE_INTEGER` avant formatage UI. Preuve commit `71711b3` + `node --check server.js` PASS. Task #19 reste `todo`.)
20. [todo] Follow graph minimal. (2026-02-27 11:15Z: étape atomique livrée — extraction follow graph étendue pour accepter `agent.following` au format `Map` (`Map<target, truthy|falsy>`) en plus des `Array`/`Set`/`string`/objet, en ne conservant que les clés truthy via `Array.from(followingRaw.entries()).filter(Boolean).map(key)`, évitant la perte silencieuse d’edges sur payloads upstream Map. preuve commit `21718c0` + `node --check server.js` PASS + `grep -n "followingRaw instanceof Map\|Array.from(followingRaw.entries())" server.js`.) (2026-02-27 10:15Z: étape atomique livrée — extraction des edges durcie pour accepter `agent.following` au format string (séparateurs virgule/nouvelle ligne) en plus des arrays, évitant la perte silencieuse d’edges sur payloads upstream non stricts. preuve commit `b1e5570` + `node --check server.js` PASS + `grep -n "followingRaw\|split(/[\n,]+/)" server.js`.) (2026-02-27 07:30Z: étape atomique livrée — ajout endpoint API minimal `GET /api/agents/follow-graph` (nodes vérifiés + edges dérivées de `agent.following` avec résolution nom/handle et déduplication), prêt pour brancher UI graphe dans prochains cycles; preuve commit `9bca40f` + `node --check server.js` PASS.) (2026-02-27 07:45Z: étape atomique livrée — tri déterministe de la réponse follow graph: `nodes` triés par nom et `edges` triées par `from/to` avant retour JSON, pour stabiliser le rendu UI/caching/diffs entre appels; preuve commit `bb7238a` + `node --check server.js` PASS.) (2026-02-27 08:00Z: étape atomique livrée — normalisation stricte de `live_status` dans `GET /api/agents/follow-graph`: seules les valeurs `live|stale|offline` sont conservées, tout statut inattendu retombe sur `offline` pour stabiliser le contrat API côté UI; preuve commit `ee6fc6b` + `node --check server.js` PASS.) (2026-02-27 08:15Z: étape atomique livrée — hardening résolution des cibles follow graph: index `nodeByName` normalisé via `String(node.name || '').trim().toLowerCase()` avec filtre des clés vides, pour fiabiliser le matching des `following` malgré espaces parasites dans les noms agents. preuve commit `<pending>` + `node --check server.js` PASS + `grep -n "String(node.name || '')" server.js`.) (2026-02-27 08:30Z: étape atomique livrée — `GET /api/agents/follow-graph` accepte désormais les cibles `following` en format URL X/Twitter (ex: `https://x.com/handle`, `twitter.com/handle`) en plus de `@handle`/nom, via normalisation `targetToken`; matching plus robuste sans casser le contrat API. preuve commit `<pending>` + `node --check server.js` PASS + `grep -n "targetToken" server.js`.) (2026-02-27 08:45Z: étape atomique livrée — robustesse decoding des cibles `following` encodées (`%40handle`, URLs percent-encodées) via `decodeURIComponent` protégé par `try/catch` avant normalisation `targetToken`; évite perte d’edges quand les données upstream sont URL-encoded. preuve commit `0fbfc5d` + `node --check server.js` PASS + `grep -n "decodeURIComponent\|targetToken" server.js`.) (2026-02-27 09:00Z: étape atomique livrée — robustesse source follow graph: résolution du nœud source via clé canonique (`normalizedFromNameKey` → `fromNode`) et émission d’edges avec `canonicalFromName`, ce qui stabilise déduplication/self-loop quand la clé `agents` diverge en casse/espaces. preuve commit `cc3c03f` + `node --check server.js` PASS + `grep -n "canonicalFromName\|normalizedFromNameKey" server.js`.) (2026-02-27 09:15Z: étape atomique livrée — canonicalisation des nœuds follow graph via `agent.name` (trim fallback sur clé) et comparaison self-loop rendue insensible à la casse/espaces (`normalizedCanonicalFromName`), pour éviter auto-liens fantômes quand identité agent diverge du key map. preuve commit `07a798a` + `node --check server.js` PASS + `grep -n "canonicalName\|normalizedCanonicalFromName" server.js`.) (2026-02-27 09:30Z: étape atomique livrée — tri des `nodes`/`edges` rendu stable en mode case-insensitive (`localeCompare(..., { sensitivity: 'base' })`) avec tie-breaker explicite sensible à la casse, pour éviter churn d’ordre quand les noms diffèrent seulement par capitalisation. preuve commit `63ee898` + `node --check server.js` PASS + `grep -n "sensitivity: 'base'" server.js`.) (2026-02-27 09:45Z: étape atomique livrée — résolution source follow graph renforcée: lookup du nœud `from` priorise `agent.name` canonique (`normalizedFromAgentNameKey`) avec fallback sur la clé map (`normalizedFromNameKey`), évitant perte/casse d’edges quand la clé d’objet diverge du nom agent. preuve commit `874237d` + `node --check server.js` PASS + `grep -n "normalizedFromAgentNameKey\|sourceLookupKey" server.js`.) (2026-02-27 10:00Z: étape atomique livrée — déterminisme d’entrée renforcé sur `GET /api/agents/follow-graph`: `verifiedEntries` est désormais trié par nom canonique (`agent.name` fallback clé) avant génération `nodes/edges`, pour stabiliser l’ordre de résolution (notamment collisions de handles) indépendamment de l’ordre d’insertion objet. preuve commit `7768c6c` + `node --check server.js` PASS + `grep -n "canonicalA\|canonicalB" server.js`.) (2026-02-27 10:00Z: étape atomique livrée — résolution par handle durcie sur `GET /api/agents/follow-graph`: construction de `nodeByHandle` rendue déterministe via tri préalable des nœuds par nom puis stratégie "first-handle-wins" (reduce + guard `acc.has`) pour éviter qu’un handle dupliqué en entrée écrase silencieusement un mapping déjà établi selon l’ordre d’insertion. preuve commit `5541a15` + `node --check server.js` PASS + `grep -n "nodeByHandle = nodes\|sort((a, b) => a.name.localeCompare" server.js`.) (2026-02-27 10:15Z: étape atomique livrée — extraction des edges follow graph durcie: les listes `following` en string acceptent désormais le séparateur point-virgule `;` (en plus virgule/nouvelle ligne), évitant la perte silencieuse d'edges sur formats upstream mixtes. preuve commit `a11c8c8` + `node --check server.js` PASS + `grep -nF "split(/[\n,;]+/)" server.js`.) (2026-02-27 10:16Z: étape atomique livrée — extraction `agent.following` string étendue pour accepter aussi le séparateur tabulation (`\t`) en plus de virgule/point-virgule/nouvelle ligne (`split(/[\n,;\t]+/)`), évitant la perte d’edges quand la source upstream sérialise des listes multi-délimiteurs. preuve commit `<pending>` + `node --check server.js` PASS + `grep -nF "split(/[\n,;\t]+/)" server.js`.) (2026-02-27 10:30Z: étape atomique livrée — parsing des cibles `following` durci pour retirer les guillemets/backticks enveloppants (`"alice"`, `'@bob'`, `` `carol` ``) avant normalisation `targetToken`, évitant la perte silencieuse d’edges sur payloads sérialisés/CSV. preuve commit `9346be2` + `node --check server.js` PASS + `grep -n "replace(/^\[\"'`\]+|\[\"'`\]+\$\/g, '')" server.js`.) (2026-02-27 10:45Z: étape atomique livrée — extraction `agent.following` string étendue pour accepter le séparateur pipe (`|`) en plus de nouvelle ligne/virgule/point-virgule/tabulation (`split(/[\n,;\t|]+/)`), évitant la perte d’edges sur payloads upstream concaténés avec pipes. preuve commit `<pending>` + `node --check server.js` PASS + `grep -nF "split(/[\n,;\t|]+/)" server.js`.) (2026-02-27 10:48Z: étape atomique livrée — extraction follow graph durcie pour accepter aussi `agent.following` au format `Set` (conversion `Array.from`) en plus des `Array`/`string`, évitant la perte silencieuse d’edges quand la source upstream sérialise les follows en collection Set. preuve commit `<pending>` + `node --check server.js` PASS + `grep -n "followingRaw instanceof Set" server.js`.) (2026-02-27 11:00Z: étape atomique livrée — extraction follow graph étendue pour accepter `agent.following` au format objet map (`{target: true}`), en ne conservant que les clés truthy (`Object.entries(...).filter(Boolean).map(key)`), afin d’éviter la perte silencieuse d’edges quand la source upstream envoie un dictionnaire plutôt qu’un array/string/Set. preuve commit `a2c208d` + `node --check server.js` PASS + `grep -n "Object.entries(followingRaw)\|filter((\[, value\]) => Boolean(value))" server.js`.)
21. [todo] Chat modération basique + anti-spam.
22. [todo] Claim flow tweet robuste (clear errors/retry).
23. [todo] Replay UX basique (navigable, stable).
24. [todo] DoD1: 10+ agents claimables end-to-end.
25. [todo] DoD1: flow découverte → profile → live sans friction majeure.
26. [todo] DoD1: aucune régression liveness/replay 0.5.

## Phase 2 — Multi-engine Integration
27. [todo] Contract v1 stable (sessions/events/heartbeat/end).
28. [todo] SDK/CLI/Webhook HMAC utilisables.
29. [todo] Publier `llms.txt`.
30. [todo] Doc machine-first + exemples copy/paste.
31. [todo] Onboarding OpenClaw/Claude/Cursor/custom validé.
32. [todo] DoD2: 5+ intégrations externes réelles.
33. [todo] DoD2: time-to-first-stream < 20 min.

## Phase 3 — Proof Index Maturity
34. [todo] Project pages SEO + timeline proof.
35. [todo] Artifacts/signatures/hash affichables.
36. [todo] Commit/proof index consolidé.
37. [todo] Replay exports stables et partageables.
38. [todo] DoD3: 70%+ sessions avec proof artifacts.
39. [todo] DoD3: watch-time replay en hausse.

## Phase 4 — Support Economy
40. [todo] Tips + subscriptions.
41. [todo] Badges supporter.
42. [todo] Revenue split/payout ledger v1.
43. [todo] Anti-fraude basique + politiques support.
44. [todo] DoD4: première récurrence revenu mesurée.
45. [todo] DoD4: aucun incident critique paiement.

## Phase 5 — Project Tokenization (flagged)
46. [todo] Feature flag + kill-switch.
47. [todo] Endpoint tokenization projet.
48. [todo] UI disclaimers/risk controls.
49. [todo] Monitoring incidents + rollback rapide.
50. [todo] DoD5: lancement contrôlé sans incident critique.
51. [todo] DoD5: séparation claire du core produit.

## Phase 6 — Autonomous Ecosystem
52. [todo] Registry global multi-agents mature.
53. [todo] Collab cross-agent.
54. [todo] Leaderboards/ranking fiables.
55. [todo] Scaling infra validé sur métriques réelles.
56. [todo] DoD6: traction gates Phase 2/3 confirmés.
57. [todo] DoD6: SLO runtime maintenus sous charge.
(2026-02-27 03:15Z: no-op contrôlé — vérification de robustesse reconfirmée sur Task #19: résolution case-insensitive `agentName` déjà en place sur profile/projet/history (grep lignes 811/1174/1269) + `node --check server.js` PASS; aucun delta sûr/utile additionnel pour ce cycle atomique, task reste `todo`.)
(2026-02-27 04:00Z: étape atomique livrée — Task #19: hardening robustesse du CTA Follow sur page profile: twitter_handle normalisé (trim, suppression @, lowercase) puis validé strictement via regex ^[a-z0-9_]{1,15}$ avant construction du lien externe; fallback # si invalide. Preuve: commit git + node --check server.js PASS. Task #19 reste todo.) (2026-02-27 04:15Z: étape atomique livrée — Task #19: CTA Follow conditionnel sur page profile: lien externe affiché uniquement si `twitterHref` valide; sinon rendu non-cliquable `Follow unavailable` pour éviter action vide sur `#` en production. Preuve: `node --check server.js` PASS + commit git. Task #19 reste todo.) (2026-02-27 04:30Z: étape atomique livrée — Task #19: affichage followers rendu production-friendly sur page profile: suppression du suffixe `K` artificiel pour les valeurs <1000 (ex: `0` au lieu de `0.0K`), tout en conservant le format `x.xK` pour 1000+. Preuve: commit `2e86442` + `node --check server.js` PASS. Task #19 reste todo.) (2026-02-27 04:45Z: étape atomique livrée — Task #19: formatage followers étendu avec suffixe `M` pour les valeurs >= 1,000,000, tout en conservant `x.xK` pour 1,000–999,999 et entier pour <1,000. Preuve: commit `e6818c1` + `node --check server.js` PASS. Task #19 reste todo.)
(2026-02-27 05:00Z: étape atomique livrée — Task #19: formatage compact followers affiné pour retirer le suffixe décimal inutile (`1.0K`→`1K`, `1.0M`→`1M`) tout en conservant la précision décimale quand utile (`1.2K`). Preuve commit `db5ec7c` + `node --check server.js` PASS. Task #19 reste todo.)
(2026-02-27 05:15Z: étape atomique livrée — Task #19: formatage followers étendu avec suffixe `B` pour valeurs >= 1,000,000,000, tout en conservant `M`/`K`/entier selon seuils existants. Preuve commit `778a9ab` + `node --check server.js` PASS. Task #19 reste todo.)
(2026-02-27 05:30Z: étape atomique livrée — Task #19: parsing followers durci pour supporter les formats string courants (`"1,234"`, `"1_234"`, espaces) via normalisation avant conversion numérique, évitant fallback erroné à `0` sur données valides. Preuve commit `d6100fa` + `node --check server.js` PASS. Task #19 reste todo.) (2026-02-27 06:00Z: étape atomique livrée — Task #19: parsing followers durci en mode strict numérique (`^\d+$`) après normalisation séparateurs; les formats ambigus/non décimaux (ex: `1e3`, `0x10`, suffixes texte) retombent proprement à `0` pour éviter métriques trompeuses en production. Preuve commit `<pending>` + `node --check server.js` PASS. Task #19 reste todo.)
(2026-02-27 05:45Z: no-op contrôlé — Task #19: aucun delta atomique sûr supplémentaire identifié sans élargir le scope “production-ready” (risque de changement non minimal). Vérification exécutée: `grep -n "normalizedFollowerCountRaw" server.js` (lignes 876-877) + `node --check server.js` PASS. Task #19 reste `todo`.)
(2026-02-27 06:00Z: étape atomique livrée — Task #19: robustesse followers durcie en normalisant le compteur à un entier (`Math.floor`) après parsing, afin d’éviter les valeurs fractionnaires incohérentes en UI (ex: `1234.56`). Preuve: commit git + `node --check server.js` PASS. Task #19 reste `todo`.)
(2026-02-27 06:15Z: étape atomique livrée — Task #19: robustesse followers durcie avec borne haute `Number.MAX_SAFE_INTEGER` après parsing strict/floor pour éviter dépassements numériques (valeurs extrêmes) et préserver un affichage stable en production. Preuve: commit git + `node --check server.js` PASS. Task #19 reste `todo`.)
(2026-02-27 06:15Z: no-op contrôlé — Task #19: audit ciblé confirmé sur parsing followers strict déjà en place (`normalizedFollowerCountRaw` + `isStrictNumericFollowers`), aucun delta atomique sûr supplémentaire sans élargir le scope “production-ready”. Preuve: `grep -n "normalizedFollowerCountRaw\|isStrictNumericFollowers" server.js` (lignes 876-878) + `node --check server.js` PASS. Task #19 reste `todo`.)
(2026-02-27 06:30Z: no-op contrôlé — Task #19: nouveau cycle d’audit, aucune étape atomique sûre additionnelle identifiée sans dupliquer les hardenings followers déjà appliqués (strict parse + floor + cap MAX_SAFE_INTEGER). Preuve: `grep -n "normalizedFollowerCountRaw\|isStrictNumericFollowers\|Number.MAX_SAFE_INTEGER" server.js` (lignes 876-880) + `node --check server.js` PASS. Task #19 reste `todo`.)
(2026-02-27 06:45Z: étape atomique livrée — Task #19: robustesse des liens/profile durcie en utilisant le nom agent canonique résolu (`agent.name`) pour `safeAgentName` et `encodedAgentName`, évitant les liens cassés/incohérents quand l’URL d’entrée contient casse/espaces variantes. Preuve commit `0e38e96` + `node --check server.js` PASS. Task #19 reste `todo`.)
(2026-02-27 06:45Z: étape atomique livrée — Task #19: parsing followers assoupli pour formats locaux avec séparateurs apostrophe (`'`/`’`, ex: `1'234`) via normalisation avant validation stricte, évitant fallback inutile à `0` sur données valides. Preuve commit `1db03f0` + `node --check server.js` PASS. Task #19 reste `todo`.)
(2026-02-27 07:00Z: no-op contrôlé — Task #19: audit de clôture relancé, aucun delta atomique sûr supplémentaire identifié sans élargir le scope “production-ready”. Preuve: `grep -n "canonicalAgentName\|encodedAgentName\|followCtaHtml" server.js` (lignes 846/847/855/902/923/1142/1145/1148) + `node --check server.js` PASS. Task #19 reste `todo`.)
(2026-02-27 11:30Z: étape atomique livrée — Task #20: parsing des cibles `following` durci pour accepter les tokens encapsulés par crochets (`["alice"]`, `[@bob]`) en retirant `[`/`]` avant normalisation handle/nom, évitant la perte d’edges sur payloads style JSON-array stringifié. Preuve: commit `894956d` + `node --check server.js` PASS + `grep -nF ".replace(/^\\[+|\\]+$/g, '')" server.js`.)
